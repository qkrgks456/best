<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<th:block th:include="fix/fixHead.html"></th:block>
<body>
<div class="wrapper">
    <th:block th:include="fix/fixSideBar"></th:block>
    <div id="content">
        <!-- 사이드바 토글 버튼 -->
        <nav class="navbar-light my-2">
            <button type="button" id="sidebarCollapse" class="btn btn-danger">
                <i class="navbar-toggler-icon"></i>
            </button>
        </nav>
        <!-- 여기서 부터 내용 넣으세요 -->
        <div class="d-flex justify-content-center">
            <div class="w-75 mt-2">
                <h3 class="px-2" th:text="${map.get('dto').title}"></h3>
                <div class="d-flex justify-content-end">
                    <div class="mx-1" th:text="'작성자 : '+${map.get('dto').id}"></div>
                    <div class="mx-1 border-start border-end border-dark px-2"
                         th:text="'조회수 : '+${map.get('dto').boardHit}"></div>
                    <div class="mx-1">추천수 : 0</div>
                </div>
                <hr/>
                <div class="px-2" th:text="${map.get('dto').content}" style="height: 400px"></div>
                <hr/>
                <th:block th:if="${#lists.size(map.get('photoList')) > 0 }">
                    <div class="d-flex justify-content-center flex-wrap">
                        <th:block th:each="photo : ${map.get('photoList')}">
                            <a th:href="${photo.path}" data-fancybox="responsive">
                                <img class="mx-1 my-1" th:src="${photo.path}" style="width: 200px;height: 200px"/>
                            </a>
                        </th:block>
                    </div>
                    <hr/>
                </th:block>
                <div class="text-center my-2">
                    <a th:href="@{/loveBoard/list/{division}/{page}(page=${page},division=${division})}"
                       class="btn btn-danger rounded-0">리스트로</a>
                    <a class="btn btn-danger rounded-0">추천</a>
                    <a class="btn btn-danger rounded-0"
                       th:if="${map.get('dto').id eq session.loginId}"
                       th:href="@{/loveBoard/boardUpdateForm/{boardNum}/{page}(boardNum=${map.get('dto').boardNum},page=${page})}">수정</a>
                    <a th:if="${map.get('dto').id eq session.loginId or sesseion.admin =='Y'}" class="btn btn-danger rounded-0"
                       id="boardDel" th:attr="boardNum=${map.get('dto').boardNum}">삭제</a>
                </div>
                <h3>댓글</h3>
                <hr/>
                <!-- 댓글 입력 폼 -->
                <div class="d-flex align-items-center mt-3">
                    <div class="form-floating flex-grow-1 px-2">
                    <textarea class="form-control rounded-0" placeholder="Leave a comment here"
                              name="commentContent" id="commentContent"
                              style="height: 100px; resize: none;"></textarea>
                        <div class="invalid-feedback">1자 이상 입력해주세요</div>
                        <label th:text="${session.loginId + '님 이곳에 댓글을 작성하세요'}" for="commentContent"></label>
                    </div>
                    <a id="cmInsertBtn" class="btn btn-danger rounded-0 btn-sm">등록</a>
                </div>
                <!-- 댓글 리스트 -->
                <div id="commentLists" class="container px-5 my-4">
                    <th:block th:each="dto : ${map.cmList}">
                        <!-- 댓글 내용 -->
                        <div class="listForm">
                            <div th:text="${dto.id}" class="fw-bold"></div>
                            <div th:text="${dto.content}" class="lh-sm"></div>
                            <div class="d-flex justify-content-end">
                                <div>
                                    <a th:if="${session.loginId ne dto.id && session.loginId != null}"
                                       class="btn btn-danger btn-sm rounded-0"
                                       href="${path}/cm/cmReportForm/${dto.cmNum}">신고</a>
                                    <th:block th:if="${session.loginId eq dto.id}">
                                        <a class='cmUpdateBtnForm btn btn-danger btn-sm rounded-0'>수정</a>
                                        <a th:attr="cmNum=${dto.cmNum}"
                                           class='cmDelBtn btn btn-danger btn-sm rounded-0'>삭제</a>
                                    </th:block>
                                </div>
                            </div>
                            <div th:text="'작성일 :' + ${dto.date}" class="d-flex justify-content-end"></div>
                            <hr/>
                        </div>
                        <!-- 수정하기 폼 -->
                        <div class="updateForm visually-hidden">
                            <div class="form-floating flex-grow-1 px-2">
                            <textarea th:text="${dto.content}" class="cmUpdateContent form-control rounded-0"
                                      style="height: 100px; resize: none;"></textarea>
                                <label>수정할 댓글을 작성하세요</label>
                                <div class="invalid-feedback">1자 이상 입력해주세요</div>
                            </div>
                            <div class="d-flex justify-content-end mt-2">
                                <a th:attr="cmNum=${dto.cmNum}"
                                   class='cmUpdateBtn btn btn-danger btn-sm rounded-0'>등록</a>
                                <a class='cmUpdateCancel btn btn-danger rounded-0 btn-sm ms-1'>취소</a>
                            </div>
                            <hr/>
                        </div>
                    </th:block>
                </div>
                <div id="paginationBox">
                    <ul class="pagination justify-content-center">
                        <li class="page-item" th:if="${map.get('startPage') ne 1}">
                            <a aria-label="Previous" class="page-link page-info rounded-0"
                               style="cursor:pointer;"
                               th:attr="page=${map.get('startPage') - 1}">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        <th:block th:each="num: ${#numbers.sequence(map.get('startPage'),map.get('endPage'))}">
                            <li th:if="${num ne map.get('currPage')}" class="page-item">
                                <a th:text="${num}" class="page-link page-info rounded-0"
                                   style="cursor:pointer;"
                                   th:attr="page=${num}"></a>
                            </li>
                            <li th:if="${num eq map.get('currPage')}" class="page-item active">
                                <a th:text="${num}" class="page-link rounded-0"></a>
                            </li>
                        </th:block>
                        <li class="page-item" th:if="${map.get('totalPage') ne map.get('endPage')}">
                            <a class="page-link page-info rounded-0"
                               style="cursor:pointer;"
                               th:attr="page=${map.get('endPage') + 1}"
                               aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<input th:attr="boardNum=${map.get('dto').boardNum}" type="hidden" id='boardNum'>
</body>
<th:block th:replace="fix/fixFooter.html"></th:block>
<script th:src="@{/js/loading.js}"></script>
<script th:src="@{/js/boardDel.js}"></script>
<script th:src="@{/js/cm.js}"></script>
</html>